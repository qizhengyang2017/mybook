2021-09-14 Tuesday

## mashr
- [x] 拿最显著的eQTL跑的mashr。 #mashr

会报错。
~/ga/tensorQTL/permute/fastqtl_to_mash_output/


## tensorQTL
通过tensorQTL得到top cis-QTL和independent cis-QTL。top cis-QTL做效应


用tensorQTL做nominal生成的是.parquet文件，可用python打开。
https://github.com/broadinstitute/tensorqtl

~/ga/tensorQTL/run_tensorQTL/nominal

```python
import pandas as pd
df = pd.read_parquet('12DPA.cis_qtl_pairs.Chr07.parquet')
```



## 文献阅读
These empirical P values were subsequently corrected for multiple testing across genes using Storey’s q value method. To identify the list of all significant variant–gene pairs associated with eGenes, variants with a nominal _P_ value below the gene-level threshold were considered significant and included in the final list of variant–gene pairs. [[@aguet2017]]

q value < 0.05 作为显著的variant-gene pairs.



Comparison of eQTL effect sizes
In order to compare effect sizes and cell type specificities of eQTLs, we utilized mash (Urbut et al., 2019) for top eVariants. The analysis was performed with eQTL beta coefficients and their standard errors as inputs. Randomly selected SNP-gene pairs (220,000) were used to fit the mash model. If the gene was not expressed in the subset, the beta coefficient was set to 0. Effect size estimates and LFSR outputted by mash were used as metrics of QTL magnitude and significance. [[@ota2021]]



 

14.1 Estimating cross tissue activity of QTLs [[@thegtexconsortium2020]]  #mashr 
In order to analyze the tissue specificity of QTLs, we used MashR [51] for every top cis-QTL per gene per tissue across all tissues where expression quantification was available. R v3.4.1 was used with mashr v0.2-6 and ashr v2.2-7. MashR was run using Z-scores as input, and 250,000 randomly selected SNP-gene pairs that were tested across all tissues were used to fit the mash model. Missing Z-score values (gene or splice quantification absent) were set to 0 and standard error to 1e6. Effect size estimates and local false sign rate (LFSR) generated by MashR were used as metrics of QTL magnitude and activity respectively. A LFSR < 0.05 was used as a threshold for significant QTL activity unless noted otherwise. 
