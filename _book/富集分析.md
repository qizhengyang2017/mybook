2021年09月18日

/data/cotton/zhenpingliu/LZP_fiberFullPopulationRNAseq/SNP_annotion/Function_enrichment


~/ga/annovar/function_enrichment

抽取基因1M区域内的SNP
1M内的SNP包含了绝大多数的SNP

基因使用鉴定eQTL的基因24407
2063612 gene_1M_SNP_uniq.txt

```
(mashr) 16:45 zyqi@login02:~/ga/annovar/function_enrichment/all_SNP_gene_1M
$wc -l gene_1M_SNP_uniq.txt
2153464 gene_1M_SNP_uniq.txt
(mashr) 16:45 zyqi@login02:~/ga/annovar/function_enrichment/all_SNP_gene_1M
$wc -l filter2_Q600_SNPs_joint_216_addID.bim
2159952 filter2_Q600_SNPs_joint_216_addID.bim
```


SNP plink
~/ga/tensorQTL/Genotypes/filter2_Q600_SNPs_joint_216_addID.bim



bedtools intersect -nonamecheck -a gene_1M.bed -b all_SNP.bed > gene_1M_SNP.txt


bedtools intersect -nonamecheck -a gene_1M.bed -b all_SNP.bed|sort|uniq > gene_1M_SNP.txt

## tensorQTL independent 结果
~/ga/annovar/function_enrichment/QTL_position

#awk 多分隔符
`zcat independent/8DPA.cis_independent_qtl.txt.gz|awk 'NR>1&&$17!=1{print $7,$17}'|awk -F'[ _]' '{print $1,$2,$3}'|les
`



cat filter2_Q600_SNPs_joint_216.exonic_variant_function|awk '{print $2,$5,$6}'|les

cat filter2_Q600_SNPs_joint_216.exonic_variant_function|awk '{print $2}'|sort|uniq



12.1 Enrichment in genomic annotations [[@thegtexconsortium2020]]
Functional enrichment analyses were performed using torus [83], with the annotations described in Section 10 and the command torus -d ${qtl_statistics} -annot ${annotation_file} -est --fastqtl. For enrichment of trans-eQTL variants, we combined the 162 intra-chromosomal variant-gene pairs discovered at 0.05 FDR across tissues, selected a random set of 5 million total background variants matched to the MAF of each variant (binning variants in the VCF into 50 bins between 0.01 and 0.5 MAF), excluding variants on the same chromosome as the gene in each pair, and computed the p-values and effect sizes as described in Section 4.6 in the corresponding tissue. For trans-eQTL enrichment, the option --no_dtss was added to ignore distance to the TSS.



#R  subset 放在函数中的天坑。筛选如果用的变量名，不能和列名相同。
![[Pasted image 20210919112354.png|400]]
帮助文档
For data frames, the subset argument works on the rows. Note that subset will be evaluated in the data frame, so columns can be referred to (by name) as variables in the expression (see the examples).

dplyr subset也一样
![[Pasted image 20210927095255.png]]


